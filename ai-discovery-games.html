<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Use Case Discovery Workshop - Microsoft AI Accelerate</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #0078d4 0%, #005a9e 100%);
            color: white;
            padding: 2.5rem 0;
            text-align: center;
            margin-bottom: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .ms-logo {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 1rem;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .progress-bar {
            background-color: #e0e0e0;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 2rem;
            overflow: hidden;
        }
        
        .progress {
            background: linear-gradient(90deg, #00d4aa 0%, #0078d4 100%);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .step {
            display: none;
            background: white;
            padding: 2.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
        }
        
        .step.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .step-header {
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .step-number {
            display: inline-block;
            background: #0078d4;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            margin-right: 15px;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        h2 {
            display: inline-block;
            color: #0078d4;
            font-size: 1.7rem;
            font-weight: 400;
        }
        
        h3 {
            color: #0078d4;
            font-size: 1.3rem;
            font-weight: 500;
            margin-bottom: 1rem;
            margin-top: 1.5rem;
        }
        
        .exercise-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            border-left: 5px solid #0078d4;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }
        
        .exercise-box h4 {
            color: #0078d4;
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .interactive-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .draggable-item {
            background: white;
            padding: 1rem;
            border: 2px dashed #ccc;
            border-radius: 8px;
            cursor: move;
            transition: all 0.3s;
        }
        
        .draggable-item:hover {
            border-color: #0078d4;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .draggable-item.dragging {
            opacity: 0.5;
        }
        
        .drop-zone {
            background: #f8f9fa;
            border: 3px dashed #0078d4;
            border-radius: 8px;
            padding: 2rem;
            min-height: 200px;
            margin: 1rem 0;
            transition: all 0.3s;
        }
        
        .drop-zone.drag-over {
            background: #e3f2fd;
            border-color: #00d4aa;
        }
        
        .timer-widget {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .timer {
            font-size: 2rem;
            color: #0078d4;
            text-align: center;
            font-weight: bold;
        }
        
        .scenario-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .scenario-card:hover {
            border-color: #0078d4;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .scenario-card.selected {
            background: #e3f2fd;
            border-color: #0078d4;
        }
        
        .pain-point-matrix {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin: 2rem 0;
        }
        
        .matrix-cell {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
        }
        
        .matrix-cell h5 {
            color: #0078d4;
            margin-bottom: 0.5rem;
        }
        
        .sticky-note {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 4px;
            padding: 0.8rem;
            margin: 0.5rem;
            font-size: 0.9rem;
            box-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            transform: rotate(-2deg);
            transition: all 0.2s;
            cursor: move;
        }
        
        .sticky-note:hover {
            transform: rotate(0deg) scale(1.05);
        }
        
        .insight-panel {
            background: #d4f4dd;
            border-left: 5px solid #00d4aa;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 2rem 0;
        }
        
        .insight-panel h4 {
            color: #1e7e34;
            margin-bottom: 1rem;
        }
        
        .collaboration-area {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .team-input {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .team-member {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }
        
        .voting-section {
            margin: 2rem 0;
        }
        
        .vote-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            border: 2px solid #e0e0e0;
        }
        
        .vote-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        .vote-btn {
            width: 40px;
            height: 40px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.2rem;
        }
        
        .vote-btn:hover {
            background: #e3f2fd;
            border-color: #0078d4;
        }
        
        .vote-btn.selected {
            background: #0078d4;
            color: white;
            border-color: #0078d4;
        }
        
        .workshop-timer {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .form-group {
            margin-bottom: 1.8rem;
        }
        
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #555;
            font-size: 0.95rem;
        }
        
        input[type="text"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: #fafafa;
        }
        
        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #0078d4;
            background-color: white;
            box-shadow: 0 0 0 3px rgba(0, 120, 212, 0.1);
        }
        
        textarea {
            resize: vertical;
            min-height: 120px;
            font-family: inherit;
        }
        
        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 2.5rem;
            padding-top: 2rem;
            border-top: 2px solid #f0f0f0;
        }
        
        button {
            padding: 14px 35px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            letter-spacing: 0.5px;
        }
        
        .btn-primary {
            background: #0078d4;
            color: white;
        }
        
        .btn-primary:hover {
            background: #005a9e;
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(0, 120, 212, 0.3);
        }
        
        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #d0d0d0;
        }
        
        .btn-success {
            background: #00d4aa;
            color: white;
        }
        
        .btn-success:hover {
            background: #00b090;
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(0, 212, 170, 0.3);
        }
        
        .results {
            background: white;
            padding: 2.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .interactive-grid {
                grid-template-columns: 1fr;
            }
            
            .pain-point-matrix {
                grid-template-columns: 1fr;
            }
            
            .team-input {
                grid-template-columns: 1fr;
            }
            
            .timer-widget {
                position: static;
                margin-bottom: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="ms-logo">MICROSOFT AI ACCELERATE</div>
            <h1>AI Use Case Discovery Workshop</h1>
            <p class="subtitle">Interactive exercises to uncover your highest-impact AI opportunities</p>
        </header>
        
        <div class="progress-bar">
            <div class="progress" id="progressBar"></div>
        </div>
        
        <!-- Timer Widget -->
        <div class="timer-widget" id="timerWidget" style="display: none;">
            <h4>Exercise Timer</h4>
            <div class="timer" id="exerciseTimer">5:00</div>
            <button class="btn-primary" onclick="startTimer()" style="padding: 8px 16px; font-size: 0.9rem;">Start</button>
        </div>
        
        <!-- Step 1: Business Context Discovery -->
        <div class="step active" id="step1">
            <div class="step-header">
                <span class="step-number">1</span>
                <h2>Business Context Discovery</h2>
            </div>
            
            <div class="exercise-box">
                <h4>🎯 Exercise 1: The 2-Minute Challenge Map</h4>
                <p>You have 2 minutes! Write down every business challenge that keeps you up at night. Don't overthink - just brain dump!</p>
                <div class="workshop-timer">
                    <button class="btn-primary" onclick="startChallengeTimer()">Start 2-Minute Timer</button>
                    <div id="challengeTimer" style="font-size: 2rem; margin-top: 1rem; display: none;">2:00</div>
                </div>
                <textarea id="challengeDump" placeholder="Type everything that comes to mind... customer complaints, slow processes, data chaos, anything!" style="min-height: 150px; display: none;"></textarea>
            </div>
            
            <div class="form-group">
                <label for="companyName">Company Name</label>
                <input type="text" id="companyName" placeholder="Enter your company name">
            </div>
            
            <div class="form-group">
                <label for="industry">Primary Industry</label>
                <select id="industry">
                    <option value="">Select your industry</option>
                    <option value="financial">Financial Services</option>
                    <option value="healthcare">Healthcare</option>
                    <option value="retail">Retail & E-commerce</option>
                    <option value="manufacturing">Manufacturing</option>
                    <option value="technology">Technology</option>
                    <option value="energy">Energy & Utilities</option>
                    <option value="government">Government</option>
                    <option value="education">Education</option>
                    <option value="other">Other</option>
                </select>
            </div>
            
            <div class="exercise-box">
                <h4>🔍 Exercise 2: Priority Ranking Game</h4>
                <p>Drag and drop these challenge categories in order of impact on your business (highest impact at top):</p>
                <div id="challengeRanking" class="drop-zone">
                    <p style="color: #999; text-align: center;">Drop challenges here in priority order</p>
                </div>
                <div class="interactive-grid" id="challengeItems">
                    <div class="draggable-item" draggable="true" data-challenge="scale">
                        📈 Scaling Operations
                    </div>
                    <div class="draggable-item" draggable="true" data-challenge="customer">
                        😊 Customer Satisfaction
                    </div>
                    <div class="draggable-item" draggable="true" data-challenge="data">
                        📊 Information Overload
                    </div>
                    <div class="draggable-item" draggable="true" data-challenge="speed">
                        ⏱️ Response Times
                    </div>
                    <div class="draggable-item" draggable="true" data-challenge="quality">
                        ✅ Quality Control
                    </div>
                    <div class="draggable-item" draggable="true" data-challenge="talent">
                        👥 Talent Shortage
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="employeeCount">Number of Employees</label>
                <input type="number" id="employeeCount" placeholder="e.g., 5000">
            </div>
            
            <div class="button-group">
                <div></div>
                <button class="btn-primary" onclick="nextStep()">Next: Process Mining</button>
            </div>
        </div>
        
        <!-- Step 2: Process Mining Exercise -->
        <div class="step" id="step2">
            <div class="step-header">
                <span class="step-number">2</span>
                <h2>Process Mining Workshop</h2>
            </div>
            
            <div class="exercise-box">
                <h4>🗺️ Exercise 3: Day in the Life Mapping</h4>
                <p>Pick a typical employee role in your organization. Map out their most frustrating daily tasks:</p>
                
                <div class="scenario-card" onclick="selectScenario('customer-service')">
                    <h5>👤 Customer Service Rep</h5>
                    <p>Map Sarah's daily struggles with customer inquiries</p>
                </div>
                
                <div class="scenario-card" onclick="selectScenario('analyst')">
                    <h5>📊 Business Analyst</h5>
                    <p>Follow Mike through his data analysis challenges</p>
                </div>
                
                <div class="scenario-card" onclick="selectScenario('custom')">
                    <h5>✏️ Custom Role</h5>
                    <p>Define your own employee scenario</p>
                </div>
            </div>
            
            <div id="processMapping" style="display: none;">
                <div class="collaboration-area">
                    <h4>📝 Activity: Sticky Note Storm</h4>
                    <p>For each task this employee does, create a virtual sticky note. Focus on repetitive, time-consuming, or error-prone activities.</p>
                    
                    <div class="pain-point-matrix">
                        <div class="matrix-cell">
                            <h5>🔄 Repetitive Tasks</h5>
                            <div id="repetitiveTasks" class="sticky-container"></div>
                            <button class="btn-secondary" onclick="addStickyNote('repetitiveTasks')" style="margin-top: 1rem; padding: 8px 16px;">+ Add Task</button>
                        </div>
                        <div class="matrix-cell">
                            <h5>⏰ Time Sinks</h5>
                            <div id="timeSinks" class="sticky-container"></div>
                            <button class="btn-secondary" onclick="addStickyNote('timeSinks')" style="margin-top: 1rem; padding: 8px 16px;">+ Add Task</button>
                        </div>
                        <div class="matrix-cell">
                            <h5>❌ Error-Prone</h5>
                            <div id="errorProne" class="sticky-container"></div>
                            <button class="btn-secondary" onclick="addStickyNote('errorProne')" style="margin-top: 1rem; padding: 8px 16px;">+ Add Task</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="exercise-box">
                <h4>💡 Exercise 4: Impact Calculator</h4>
                <p>For your top 3 processes, estimate the weekly impact:</p>
                
                <div id="impactCalculator">
                    <div class="team-input">
                        <div class="team-member">
                            <h5>Process 1</h5>
                            <input type="text" placeholder="Process name" class="process-name-calc">
                            <div style="margin-top: 1rem;">
                                <label>Times per week:</label>
                                <input type="number" placeholder="100" class="process-frequency">
                                <label style="margin-top: 0.5rem;">Minutes per occurrence:</label>
                                <input type="number" placeholder="15" class="process-duration">
                            </div>
                        </div>
                        <div class="team-member">
                            <h5>Process 2</h5>
                            <input type="text" placeholder="Process name" class="process-name-calc">
                            <div style="margin-top: 1rem;">
                                <label>Times per week:</label>
                                <input type="number" placeholder="50" class="process-frequency">
                                <label style="margin-top: 0.5rem;">Minutes per occurrence:</label>
                                <input type="number" placeholder="30" class="process-duration">
                            </div>
                        </div>
                    </div>
                    <button class="btn-secondary" onclick="calculateImpact()" style="margin-top: 1rem;">Calculate Total Impact</button>
                    <div id="impactResults" style="margin-top: 1rem; display: none;" class="insight-panel"></div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn-secondary" onclick="previousStep()">Previous</button>
                <button class="btn-primary" onclick="nextStep()">Next: Deep Dive Analysis</button>
            </div>
        </div>
        
        <!-- Step 3: Interactive Deep Dive -->
        <div class="step" id="step3">
            <div class="step-header">
                <span class="step-number">3</span>
                <h2>Process Deep Dive Lab</h2>
            </div>
            
            <div class="exercise-box">
                <h4>🎮 Exercise 5: Pain Point Bingo</h4>
                <p>Click all the pain points that apply to your processes. Try to get a "bingo" (complete row or column)!</p>
                
                <div id="bingBoard" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 1rem;">
                    <!-- Bingo board will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="exercise-box">
                <h4>🏆 Exercise 6: Team Voting Session</h4>
                <p>Get your team involved! Have everyone vote on which processes cause the most frustration:</p>
                
                <div class="voting-section">
                    <div class="vote-item">
                        <span>Finding the right information</span>
                        <div class="vote-buttons">
                            <button class="vote-btn" onclick="vote(this, 1)">😐</button>
                            <button class="vote-btn" onclick="vote(this, 2)">😤</button>
                            <button class="vote-btn" onclick="vote(this, 3)">🤯</button>
                        </div>
                    </div>
                    <div class="vote-item">
                        <span>Repetitive customer questions</span>
                        <div class="vote-buttons">
                            <button class="vote-btn" onclick="vote(this, 1)">😐</button>
                            <button class="vote-btn" onclick="vote(this, 2)">😤</button>
                            <button class="vote-btn" onclick="vote(this, 3)">🤯</button>
                        </div>
                    </div>
                    <div class="vote-item">
                        <span>Manual data entry/analysis</span>
                        <div class="vote-buttons">
                            <button class="vote-btn" onclick="vote(this, 1)">😐</button>
                            <button class="vote-btn" onclick="vote(this, 2)">😤</button>
                            <button class="vote-btn" onclick="vote(this, 3)">🤯</button>
                        </div>
                    </div>
                    <div class="vote-item">
                        <span>Compliance and approvals</span>
                        <div class="vote-buttons">
                            <button class="vote-btn" onclick="vote(this, 1)">😐</button>
                            <button class="vote-btn" onclick="vote(this, 2)">😤</button>
                            <button class="vote-btn" onclick="vote(this, 3)">🤯</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn-secondary" onclick="previousStep()">Previous</button>
                <button class="btn-primary" onclick="nextStep()">Next: Data Discovery</button>
            </div>
        </div>
        
        <!-- Step 4: Data & Systems Discovery -->
        <div class="step" id="step4">
            <div class="step-header">
                <span class="step-number">4</span>
                <h2>Data & Systems Treasure Hunt</h2>
            </div>
            
            <div class="exercise-box">
                <h4>🗃️ Exercise 7: Data Inventory Speed Run</h4>
                <p>You have 3 minutes! List every type of data your organization collects or creates:</p>
                
                <div class="workshop-timer">
                    <button class="btn-primary" onclick="startDataTimer()">Start 3-Minute Timer</button>
                    <div id="dataTimer" style="font-size: 2rem; margin-top: 1rem; display: none;">3:00</div>
                </div>
                
                <div id="dataCategories" style="display: none; margin-top: 1rem;">
                    <div class="interactive-grid">
                        <div class="team-member">
                            <h5>📧 Communications</h5>
                            <textarea placeholder="Emails, chats, calls..." style="min-height: 100px;"></textarea>
                        </div>
                        <div class="team-member">
                            <h5>📄 Documents</h5>
                            <textarea placeholder="Reports, contracts, policies..." style="min-height: 100px;"></textarea>
                        </div>
                        <div class="team-member">
                            <h5>💳 Transactions</h5>
                            <textarea placeholder="Sales, payments, orders..." style="min-height: 100px;"></textarea>
                        </div>
                        <div class="team-member">
                            <h5>🔧 Operations</h5>
                            <textarea placeholder="Logs, metrics, sensor data..." style="min-height: 100px;"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="exercise-box">
                <h4>🔗 Exercise 8: System Integration Puzzle</h4>
                <p>Connect the dots! Draw lines between systems that need to talk to each other:</p>
                
                <canvas id="systemCanvas" width="800" height="400" style="border: 2px solid #e0e0e0; border-radius: 8px; width: 100%; background: white;"></canvas>
                
                <p style="margin-top: 1rem; font-size: 0.9rem; color: #666;">Click on two systems to connect them. Red lines = problematic integrations</p>
            </div>
            
            <div class="form-group">
                <label>Rate your data readiness with this interactive scale:</label>
                <div style="position: relative; margin: 2rem 0;">
                    <input type="range" min="1" max="10" value="5" class="slider" id="dataReadiness" style="width: 100%;">
                    <div style="display: flex; justify-content: space-between; margin-top: 1rem;">
                        <span>😵 Data Chaos</span>
                        <span>🤔 Getting There</span>
                        <span>🎯 Data Ready!</span>
                    </div>
                    <div id="readinessMessage" style="text-align: center; margin-top: 1rem; font-weight: bold; color: #0078d4;"></div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn-secondary" onclick="previousStep()">Previous</button>
                <button class="btn-success" onclick="calculateResults()">Generate AI Opportunities 🚀</button>
            </div>
        </div>
        
        <!-- Results -->
        <div class="step" id="results">
            <div class="results">
                <h2 style="color: #0078d4; margin-bottom: 2rem;">Your AI Transformation Roadmap</h2>
                
                <div class="insight-panel">
                    <h4>🎉 Congratulations! Based on your workshop inputs:</h4>
                    <div id="summaryInsights"></div>
                </div>
                
                <div id="aiOpportunities" style="margin-top: 2rem;">
                    <!-- AI opportunities will be populated here -->
                </div>
                
                <div class="button-group" style="margin-top: 2rem;">
                    <button class="btn-secondary" onclick="location.reload()">Run Workshop Again</button>
                    <button class="btn-primary" onclick="exportWorkshopResults()">Export Results</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let currentStep = 1;
        const totalSteps = 4;
        let workshopData = {
            company: {},
            challenges: [],
            processes: [],
            painPoints: [],
            data: [],
            systems: [],
            votes: {}
        };
        
        // Initialize interactive elements
        window.addEventListener('DOMContentLoaded', function() {
            initializeDragAndDrop();
            createBingoBoard();
            initializeSystemCanvas();
            updateDataReadiness();
        });
        
        // Drag and Drop functionality
        function initializeDragAndDrop() {
            const draggables = document.querySelectorAll('.draggable-item');
            const dropZone = document.getElementById('challengeRanking');
            
            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', (e) => {
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/html', e.target.innerHTML);
                    e.dataTransfer.setData('challenge', e.target.dataset.challenge);
                    e.target.classList.add('dragging');
                });
                
                draggable.addEventListener('dragend', (e) => {
                    e.target.classList.remove('dragging');
                });
            });
            
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('drag-over');
            });
            
            dropZone.addEventListener('dragleave', () => {
                dropZone.classList.remove('drag-over');
            });
            
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('drag-over');
                
                const challenge = e.dataTransfer.getData('challenge');
                const content = e.dataTransfer.getData('text/html');
                
                if (dropZone.querySelector('p')) {
                    dropZone.querySelector('p').remove();
                }
                
                const newItem = document.createElement('div');
                newItem.className = 'draggable-item';
                newItem.innerHTML = content;
                newItem.style.margin = '0.5rem 0';
                dropZone.appendChild(newItem);
                
                // Store the ranking
                if (!workshopData.challenges.includes(challenge)) {
                    workshopData.challenges.push(challenge);
                }
            });
        }
        
        // Timer functions
        function startChallengeTimer() {
            const timerDiv = document.getElementById('challengeTimer');
            const textarea = document.getElementById('challengeDump');
            const button = event.target;
            
            button.style.display = 'none';
            timerDiv.style.display = 'block';
            textarea.style.display = 'block';
            textarea.focus();
            
            let time = 120; // 2 minutes
            const interval = setInterval(() => {
                const minutes = Math.floor(time / 60);
                const seconds = time % 60;
                timerDiv.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (time === 0) {
                    clearInterval(interval);
                    timerDiv.textContent = "Time's up! Great job!";
                    textarea.style.border = '3px solid #00d4aa';
                }
                time--;
            }, 1000);
        }
        
        function startDataTimer() {
            const timerDiv = document.getElementById('dataTimer');
            const categories = document.getElementById('dataCategories');
            const button = event.target;
            
            button.style.display = 'none';
            timerDiv.style.display = 'block';
            categories.style.display = 'block';
            
            let time = 180; // 3 minutes
            const interval = setInterval(() => {
                const minutes = Math.floor(time / 60);
                const seconds = time % 60;
                timerDiv.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (time === 0) {
                    clearInterval(interval);
                    timerDiv.textContent = "Time's up! Nice data inventory!";
                }
                time--;
            }, 1000);
        }
        
        // Scenario selection
        function selectScenario(type) {
            document.querySelectorAll('.scenario-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.scenario-card').classList.add('selected');
            document.getElementById('processMapping').style.display = 'block';
            workshopData.scenarioType = type;
        }
        
        // Sticky note functionality
        function addStickyNote(category) {
            const container = document.getElementById(category);
            const task = prompt('Describe the task:');
            
            if (task) {
                const sticky = document.createElement('div');
                sticky.className = 'sticky-note';
                sticky.textContent = task;
                sticky.draggable = true;
                container.appendChild(sticky);
                
                // Store in workshop data
                if (!workshopData.processes[category]) {
                    workshopData.processes[category] = [];
                }
                workshopData.processes[category].push(task);
            }
        }
        
        // Impact calculator
        function calculateImpact() {
            const processes = document.querySelectorAll('.team-member');
            let totalHours = 0;
            let impactHTML = '<h4>📊 Weekly Impact Analysis</h4>';
            
            processes.forEach((process, index) => {
                const name = process.querySelector('.process-name-calc').value || `Process ${index + 1}`;
                const frequency = parseInt(process.querySelector('.process-frequency').value) || 0;
                const duration = parseInt(process.querySelector('.process-duration').value) || 0;
                
                const weeklyMinutes = frequency * duration;
                const weeklyHours = weeklyMinutes / 60;
                totalHours += weeklyHours;
                
                if (frequency && duration) {
                    impactHTML += `<p><strong>${name}:</strong> ${weeklyHours.toFixed(1)} hours/week</p>`;
                }
            });
            
            impactHTML += `<p style="font-size: 1.2rem; margin-top: 1rem;"><strong>Total Impact: ${totalHours.toFixed(1)} hours/week</strong></p>`;
            impactHTML += `<p>That's ${(totalHours * 52).toFixed(0)} hours per year! 🤯</p>`;
            
            document.getElementById('impactResults').innerHTML = impactHTML;
            document.getElementById('impactResults').style.display = 'block';
        }
        
        // Bingo board
        function createBingoBoard() {
            const painPoints = [
                'Too many emails', 'Can\'t find docs', 'Manual copying', 'Waiting for approvals',
                'Duplicate work', 'Outdated info', 'No automation', 'Excel overload',
                'Meeting madness', 'Status updates', 'Version control', 'Knowledge silos',
                'Slow systems', 'Multiple logins', 'Paper forms', 'Phone tag'
            ];
            
            const board = document.getElementById('bingBoard');
            if (!board) return;
            
            painPoints.forEach(point => {
                const cell = document.createElement('div');
                cell.className = 'scenario-card';
                cell.style.padding = '1rem';
                cell.style.fontSize = '0.9rem';
                cell.textContent = point;
                cell.onclick = function() {
                    this.classList.toggle('selected');
                    checkBingo();
                };
                board.appendChild(cell);
            });
        }
        
        function checkBingo() {
            // Simplified bingo check - if 4 in a row are selected
            const selected = document.querySelectorAll('#bingBoard .selected').length;
            if (selected >= 4) {
                const panel = document.createElement('div');
                panel.className = 'insight-panel';
                panel.innerHTML = '<h4>🎉 BINGO! You\'ve identified major pain points!</h4>';
                document.getElementById('bingBoard').parentElement.appendChild(panel);
            }
        }
        
        // Voting functionality
        function vote(button, level) {
            const voteButtons = button.parentElement.querySelectorAll('.vote-btn');
            voteButtons.forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
            
            const voteName = button.closest('.vote-item').querySelector('span').textContent;
            workshopData.votes[voteName] = level;
        }
        
        // System canvas
        function initializeSystemCanvas() {
            const canvas = document.getElementById('systemCanvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = 400;
            
            const systems = [
                {name: 'Email/Office', x: 100, y: 100},
                {name: 'CRM', x: 300, y: 100},
                {name: 'ERP', x: 500, y: 100},
                {name: 'Custom Apps', x: 700, y: 100},
                {name: 'Databases', x: 200, y: 250},
                {name: 'Cloud Storage', x: 400, y: 250},
                {name: 'Analytics', x: 600, y: 250}
            ];
            
            // Draw systems
            systems.forEach(system => {
                ctx.fillStyle = '#0078d4';
                ctx.fillRect(system.x - 50, system.y - 25, 100, 50);
                ctx.fillStyle = 'white';
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(system.name, system.x, system.y + 5);
            });
            
            let selectedSystem = null;
            
            canvas.addEventListener('click', (e) => {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const clicked = systems.find(s => 
                    x >= s.x - 50 && x <= s.x + 50 &&
                    y >= s.y - 25 && y <= s.y + 25
                );
                
                if (clicked) {
                    if (selectedSystem) {
                        // Draw connection
                        ctx.strokeStyle = selectedSystem.name === 'Custom Apps' ? '#ff0000' : '#00d4aa';
                        ctx.lineWidth = 3;
                        ctx.beginPath();
                        ctx.moveTo(selectedSystem.x, selectedSystem.y);
                        ctx.lineTo(clicked.x, clicked.y);
                        ctx.stroke();
                        
                        selectedSystem = null;
                    } else {
                        selectedSystem = clicked;
                        // Highlight selected
                        ctx.strokeStyle = '#ffc107';
                        ctx.lineWidth = 3;
                        ctx.strokeRect(clicked.x - 52, clicked.y - 27, 104, 54);
                    }
                }
            });
        }
        
        // Data readiness
        function updateDataReadiness() {
            const slider = document.getElementById('dataReadiness');
            const message = document.getElementById('readinessMessage');
            
            slider.addEventListener('input', function() {
                const value = parseInt(this.value);
                let text = '';
                
                if (value <= 3) text = "😵 We have work to do, but AI can still help!";
                else if (value <= 6) text = "🤔 Getting there! Good foundation for AI.";
                else if (value <= 8) text = "😊 Nice! You're well-positioned for AI.";
                else text = "🎯 Excellent! You're AI-ready!";
                
                message.textContent = text;
            });
        }
        
        // Navigation
        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }
        
        function nextStep() {
            collectStepData(currentStep);
            document.getElementById(`step${currentStep}`).classList.remove('active');
            currentStep++;
            document.getElementById(`step${currentStep}`).classList.add('active');
            updateProgress();
            window.scrollTo(0, 0);
        }
        
        function previousStep() {
            document.getElementById(`step${currentStep}`).classList.remove('active');
            currentStep--;
            document.getElementById(`step${currentStep}`).classList.add('active');
            updateProgress();
            window.scrollTo(0, 0);
        }
        
        function collectStepData(step) {
            switch(step) {
                case 1:
                    workshopData.company = {
                        name: document.getElementById('companyName').value || 'Your Company',
                        industry: document.getElementById('industry').value,
                        employees: parseInt(document.getElementById('employeeCount').value) || 1000,
                        challengeBrainstorm: document.getElementById('challengeDump').value
                    };
                    break;
                case 2:
                    // Process data already collected during exercises
                    break;
                case 3:
                    // Pain points collected through bingo and voting
                    break;
                case 4:
                    workshopData.dataReadiness = parseInt(document.getElementById('dataReadiness').value);
                    break;
            }
        }
        
        function calculateResults() {
            collectStepData(currentStep);
            
            // Generate insights
            const insights = generateInsights();
            document.getElementById('summaryInsights').innerHTML = insights;
            
            // Generate AI opportunities
            const opportunities = generateAIOpportunities();
            document.getElementById('aiOpportunities').innerHTML = opportunities;
            
            // Show results
            document.getElementById(`step${currentStep}`).classList.remove('active');
            document.getElementById('results').classList.add('active');
            window.scrollTo(0, 0);
        }
        
        function generateInsights() {
            let html = '<ul>';
            html += `<li>You identified <strong>${workshopData.challenges.length}</strong> key business challenges</li>`;
            html += `<li>Your team mapped <strong>${Object.values(workshopData.processes).flat().length}</strong> processes that need improvement</li>`;
            html += `<li>Data readiness score: <strong>${workshopData.dataReadiness}/10</strong></li>`;
            
            if (workshopData.votes && Object.keys(workshopData.votes).length > 0) {
                const topPain = Object.entries(workshopData.votes).sort((a, b) => b[1] - a[1])[0];
                html += `<li>Top voted pain point: <strong>${topPain[0]}</strong></li>`;
            }
            
            html += '</ul>';
            return html;
        }
        
        function generateAIOpportunities() {
            let html = '<h3>🚀 Your Top AI Opportunities</h3>';
            
            // Generate opportunities based on workshop data
            const opportunities = [
                {
                    title: 'Intelligent Knowledge Assistant',
                    description: 'Based on your information finding challenges, implement an AI agent that instantly retrieves answers from your knowledge base.',
                    impact: 'Save 20+ hours/week',
                    complexity: 'Low'
                },
                {
                    title: 'Process Automation Agent',
                    description: 'Automate your repetitive tasks identified in the workshop with an AI agent that handles routine work.',
                    impact: 'Automate 70% of routine tasks',
                    complexity: 'Medium'
                },
                {
                    title: 'Customer Experience AI',
                    description: 'Deploy conversational AI to handle customer inquiries based on your pain points.',
                    impact: 'Reduce response time by 80%',
                    complexity: 'Low'
                }
            ];
            
            opportunities.forEach((opp, index) => {
                html += `
                    <div class="scenario-card" style="margin-bottom: 1rem;">
                        <h4>${index + 1}. ${opp.title}</h4>
                        <p>${opp.description}</p>
                        <div style="display: flex; justify-content: space-between; margin-top: 1rem;">
                            <span><strong>Impact:</strong> ${opp.impact}</span>
                            <span><strong>Complexity:</strong> ${opp.complexity}</span>
                        </div>
                    </div>
                `;
            });
            
            return html;
        }
        
        function exportWorkshopResults() {
            const results = {
                workshopDate: new Date().toISOString(),
                company: workshopData.company,
                insights: {
                    challenges: workshopData.challenges,
                    processes: workshopData.processes,
                    painPoints: workshopData.votes,
                    dataReadiness: workshopData.dataReadiness
                },
                recommendations: 'See detailed opportunity analysis above'
            };
            
            const blob = new Blob([JSON.stringify(results, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ai-workshop-results-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Initialize
        updateProgress();
    </script>
</body>
</html>
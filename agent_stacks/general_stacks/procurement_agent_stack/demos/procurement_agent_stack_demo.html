<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Procurement Agent - M365 Copilot</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, system-ui, sans-serif; background: #faf9f8; height: 100vh; display: flex; overflow: hidden; color: #323130; }
        .sidebar { width: 260px; background: #ffffff; display: flex; flex-direction: column; border-right: 1px solid #edebe9; }
        .sidebar-header { padding: 12px 16px; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid #edebe9; height: 48px; }
        .copilot-icon { width: 24px; height: 24px; background: linear-gradient(135deg, #00a4ef 0%, #7fba00 100%); border-radius: 4px; display: flex; align-items: center; justify-content: center; position: relative; }
        .copilot-icon::before { content: "üõí"; font-size: 14px; filter: brightness(0) invert(1); }
        .sidebar-title { font-size: 14px; font-weight: 600; color: #323130; }
        .nav-section { flex: 1; overflow-y: auto; padding: 4px 0; }
        .nav-item { padding: 8px 16px; display: flex; align-items: center; gap: 12px; cursor: pointer; font-size: 14px; color: #323130; transition: background 0.1s; position: relative; user-select: none; }
        .nav-item:hover { background: #f3f2f1; }
        .nav-item.active { background: #f3f2f1; }
        .nav-item.active::before { content: ""; position: absolute; left: 0; top: 8px; bottom: 8px; width: 2px; background: #00a4ef; border-radius: 1px; }
        .main-content { flex: 1; display: flex; flex-direction: column; background: #faf9f8; }
        .content-header { height: 48px; padding: 0 20px; display: flex; align-items: center; justify-content: space-between; background: #ffffff; border-bottom: 1px solid #edebe9; }
        .demo-controls { padding: 16px 20px; background: #f3f2f1; display: flex; align-items: center; gap: 16px; border-bottom: 1px solid #edebe9; }
        .demo-button { padding: 8px 16px; background: #00a4ef; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 600; transition: background 0.2s; }
        .demo-button:hover { background: #0078d4; }
        .demo-button:disabled { background: #a19f9d; cursor: not-allowed; }
        .demo-button.secondary { background: #605e5c; }
        .chat-container { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        .chat-messages { flex: 1; overflow-y: auto; padding: 20px; }
        .message { max-width: 900px; margin: 0 auto 24px; animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .message-header { display: flex; align-items: center; gap: 12px; margin-bottom: 8px; }
        .message-avatar-user { width: 28px; height: 28px; border-radius: 50%; background: #5b5fc7; color: white; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; }
        .message-avatar-agent { width: 28px; height: 28px; border-radius: 6px; background: linear-gradient(135deg, #00a4ef 0%, #7fba00 100%); color: white; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 600; }
        .message-content { margin-left: 40px; font-size: 14px; line-height: 1.6; color: #323130; }
        .agent-card { margin-left: 40px; margin-top: 16px; background: white; border: 1px solid #edebe9; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); }
        .agent-card-header { padding: 16px; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid #edebe9; background: #faf9f8; }
        .agent-card-content { padding: 16px; }
        .detail-list { list-style: none; }
        .detail-item { padding: 8px 0; font-size: 14px; color: #323130; display: flex; gap: 8px; }
        .detail-label { font-weight: 600; min-width: 140px; color: #605e5c; }
        .typing-indicator { margin-left: 40px; display: flex; gap: 4px; padding: 8px 0; }
        .typing-dot { width: 8px; height: 8px; background: #605e5c; border-radius: 50%; animation: typing 1.4s infinite; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing { 0%, 60%, 100% { transform: translateY(0); opacity: 0.5; } 30% { transform: translateY(-10px); opacity: 1; } }
        .data-table { width: 100%; border-collapse: collapse; font-size: 14px; margin-top: 12px; }
        .data-table th { background: #faf9f8; padding: 12px 16px; text-align: left; font-weight: 600; color: #323130; border-bottom: 1px solid #edebe9; }
        .data-table td { padding: 12px 16px; color: #605e5c; border-bottom: 1px solid #edebe9; }
        .data-table tr:hover td { background: #faf9f8; }
        .badge { display: inline-block; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 600; }
        .badge.success { background: #d4edda; color: #155724; }
        .badge.warning { background: #fff3cd; color: #856404; }
        .badge.info { background: #d1ecf1; color: #0c5460; }
        .badge.danger { background: #f8d7da; color: #721c24; }
        .approval-status { display: flex; align-items: center; gap: 8px; padding: 8px; background: #e7f3ff; border-radius: 4px; margin: 8px 0; }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="copilot-icon"></div>
            <span class="sidebar-title">Procurement Agent</span>
        </div>
        <div class="nav-section">
            <div class="nav-item active"><span>üìã</span><span>Purchase Orders</span></div>
            <div class="nav-item"><span>üè¢</span><span>Vendor Management</span></div>
            <div class="nav-item"><span>‚úÖ</span><span>Approvals</span></div>
            <div class="nav-item"><span>üìä</span><span>Spending Analytics</span></div>
            <div class="nav-item"><span>üíº</span><span>RFQ Management</span></div>
        </div>
    </div>
    <div class="main-content">
        <div class="content-header">
            <div class="header-title">Procurement Agent - Intelligent Purchase Management</div>
        </div>
        <div class="demo-controls">
            <button class="demo-button" onclick="startDemo()" id="playButton">‚ñ∂ Play Demo</button>
            <button class="demo-button secondary" onclick="pauseDemo()" id="pauseButton" disabled>‚è∏ Pause</button>
            <button class="demo-button secondary" onclick="resetDemo()">‚Ü∫ Reset</button>
            <button class="demo-button secondary" onclick="skipMessage()">‚è≠ Skip</button>
            <span style="margin-left: auto; font-size: 14px; color: #605e5c;" id="demoStatus">Ready to start</span>
        </div>
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages"></div>
        </div>
    </div>
    <script>
        let currentMessageIndex = 0;
        let isPlaying = false;
        let isPaused = false;
        let messageTimeout;
        let typingTimeout;

        const demoScript = [
            {
                "type": "user",
                "content": "I need to order 50 laptops for the new engineering team. Can you show me our approved vendors for IT equipment?",
                "typingTime": 1500,
                "delay": 1000
            },
            {
                "type": "agent",
                "content": "I'll retrieve our approved IT equipment vendors and their current ratings, pricing tiers, and delivery capabilities for your laptop procurement.",
                "typingTime": 2000,
                "delay": 1500,
                "agentData": {
                    "Approved Vendors": {
                        "TechPro Solutions": "<span class='badge success'>Preferred</span> - Rating: 4.8/5",
                        "Global IT Supply": "<span class='badge info'>Standard</span> - Rating: 4.5/5",
                        "CompuDirect": "<span class='badge info'>Standard</span> - Rating: 4.3/5",
                        "Enterprise Hardware Co": "<span class='badge warning'>Conditional</span> - Rating: 3.9/5"
                    },
                    "Vendor Comparison": {
                        "Best Price": "CompuDirect - $1,150/unit",
                        "Fastest Delivery": "TechPro Solutions - 3-5 business days",
                        "Best Terms": "Global IT Supply - Net 60 payment",
                        "Volume Discount": "TechPro Solutions - 5% off for 50+ units"
                    },
                    "Recent Performance": {
                        "TechPro Solutions": "98% on-time delivery, 0 defects last quarter",
                        "Contract Status": "Master agreement valid until Dec 2025",
                        "Spending YTD": "$287,500 (42% of IT budget)",
                        "Open Orders": "2 active orders totaling $45,000"
                    }
                }
            },
            {
                "type": "user",
                "content": "Let's go with TechPro Solutions. Create a purchase order for 50 Dell Latitude 7440 laptops with our standard engineering configuration.",
                "typingTime": 1600,
                "delay": 1000
            },
            {
                "type": "agent",
                "content": "Creating purchase order for 50 Dell Latitude 7440 laptops with engineering configuration from TechPro Solutions. I'll include the volume discount and route it for approval.",
                "typingTime": 2100,
                "delay": 1500,
                "agentData": {
                    "Purchase Order Details": {
                        "PO Number": "PO-2024-11-27-0892",
                        "Vendor": "TechPro Solutions",
                        "Created By": "Procurement Agent AI",
                        "Department": "Engineering",
                        "Cost Center": "ENG-2024-Q4"
                    },
                    "Line Items": {
                        "Dell Latitude 7440": "50 units @ $1,250 each",
                        "Configuration": "i7-1365U, 32GB RAM, 1TB SSD",
                        "Windows 11 Pro License": "50 licenses included",
                        "3-Year Warranty": "50 units @ $150 each",
                        "Docking Stations": "50 units @ $189 each"
                    },
                    "Financial Summary": {
                        "Subtotal": "$79,450.00",
                        "Volume Discount (5%)": "-$3,972.50",
                        "Shipping": "Free (order > $50k)",
                        "Tax (8.5%)": "$6,415.59",
                        "Total Amount": "<strong>$81,893.09</strong>"
                    },
                    "Approval Workflow": {
                        "Level 1": "Department Manager - <span class='badge success'>Auto-approved</span>",
                        "Level 2": "Finance Director - <span class='badge warning'>Pending</span>",
                        "Level 3": "CFO (required >$75k) - <span class='badge warning'>Pending</span>",
                        "Estimated Approval": "2-3 business days",
                        "Teams Notification": "Sent to approvers"
                    }
                }
            },
            {
                "type": "user",
                "content": "Check the approval status and send a reminder to the Finance Director with urgency note about the new team starting next week.",
                "typingTime": 1700,
                "delay": 1000
            },
            {
                "type": "agent",
                "content": "Checking current approval status and sending an urgent reminder through Microsoft Teams to the Finance Director with context about the new engineering team start date.",
                "typingTime": 2000,
                "delay": 1500,
                "agentData": {
                    "Approval Status Update": {
                        "Current Status": "<span class='badge warning'>Awaiting Finance Approval</span>",
                        "Time in Queue": "4 hours 23 minutes",
                        "Finance Director": "Sarah Thompson",
                        "Average Response Time": "Usually responds within 6 hours",
                        "Escalation Available": "After 24 hours"
                    },
                    "Teams Notification Sent": {
                        "To": "@Sarah Thompson",
                        "Channel": "Finance Approvals",
                        "Priority": "<span class='badge danger'>High Priority</span>",
                        "Message": "URGENT: PO approval needed for engineering laptops",
                        "Context Added": "New team starts Monday, Nov 4th"
                    },
                    "Alternative Actions": {
                        "Split Order": "Create 2 POs under $75k to avoid CFO approval",
                        "Expedite Option": "Use emergency procurement (CEO pre-approval)",
                        "Rental Option": "45-day rental available while awaiting delivery",
                        "Stock Check": "IT has 12 similar laptops available immediately"
                    }
                }
            },
            {
                "type": "user",
                "content": "Show me our spending analytics for IT equipment this quarter and how this purchase affects our budget.",
                "typingTime": 1500,
                "delay": 1000
            },
            {
                "type": "agent",
                "content": "Analyzing IT equipment spending for Q4 2024 and calculating the budget impact of this laptop purchase order.",
                "typingTime": 2000,
                "delay": 1500,
                "agentData": {
                    "Q4 2024 IT Spending": {
                        "Budget Allocated": "$450,000",
                        "Spent to Date": "$287,500 (63.9%)",
                        "Pending Orders": "$81,893 (this PO)",
                        "Remaining Budget": "$80,607 (17.9%)",
                        "Days Left in Quarter": "34 days"
                    },
                    "Category Breakdown": {
                        "Laptops/Desktops": "$198,400 (69%)",
                        "Software Licenses": "$42,300 (14.7%)",
                        "Networking Equipment": "$28,900 (10%)",
                        "Accessories": "$17,900 (6.3%)"
                    },
                    "Vendor Distribution": {
                        "TechPro Solutions": "58% of spend",
                        "Global IT Supply": "22% of spend",
                        "CompuDirect": "15% of spend",
                        "Others": "5% of spend"
                    },
                    "Budget Recommendations": {
                        "Risk Level": "<span class='badge warning'>Medium</span> - 82% committed",
                        "Suggested Action": "Review Q1 2025 early requirements",
                        "Cost Savings Found": "$12,400 in duplicate software licenses",
                        "Year-End Forecast": "Expected 94% budget utilization"
                    }
                }
            },
            {
                "type": "user",
                "content": "Create an RFQ for office furniture for the same engineering team - 50 desks, chairs, and monitor arms. Send to our top 3 furniture vendors.",
                "typingTime": 1600,
                "delay": 1000
            },
            {
                "type": "agent",
                "content": "Creating and distributing an RFQ for office furniture to our top-rated furniture vendors. I'll set a response deadline and track quotes in the system.",
                "typingTime": 2100,
                "delay": 1500,
                "agentData": {
                    "RFQ Created": {
                        "RFQ Number": "RFQ-2024-11-27-0145",
                        "Category": "Office Furniture",
                        "Quantity": "50 workstations",
                        "Response Deadline": "November 29, 2024 5:00 PM",
                        "Decision Date": "November 30, 2024"
                    },
                    "Items Requested": {
                        "Standing Desks": "50 units - 60\" adjustable height",
                        "Ergonomic Chairs": "50 units - high back, lumbar support",
                        "Monitor Arms": "50 units - dual monitor capable",
                        "Filing Cabinets": "50 units - 3-drawer mobile",
                        "Estimated Budget": "$75,000-$95,000"
                    },
                    "Vendors Notified": {
                        "WorkSpace Plus": "‚úì Sent - Read receipt confirmed",
                        "Office Innovations": "‚úì Sent - Auto-reply received",
                        "Commercial Interiors": "‚úì Sent - Rep acknowledged",
                        "Response Rate": "Typically 95% respond within 48hrs"
                    },
                    "Evaluation Criteria": {
                        "Price Weight": "40%",
                        "Delivery Time": "25%",
                        "Warranty Terms": "20%",
                        "Sustainability": "15%",
                        "Auto-Scoring": "Enabled for objective comparison"
                    }
                }
            }
        ];

        function startDemo() {
            if (!isPlaying || isPaused) {
                isPlaying = true;
                isPaused = false;
                document.getElementById('playButton').disabled = true;
                document.getElementById('pauseButton').disabled = false;
                document.getElementById('demoStatus').textContent = 'Playing demo...';
                if (currentMessageIndex === 0) {
                    document.getElementById('chatMessages').innerHTML = '';
                }
                playNextMessage();
            }
        }

        function pauseDemo() {
            if (isPlaying) {
                isPaused = true;
                isPlaying = false;
                clearTimeout(messageTimeout);
                clearTimeout(typingTimeout);
                document.getElementById('playButton').disabled = false;
                document.getElementById('pauseButton').disabled = true;
                document.getElementById('demoStatus').textContent = 'Demo paused';
                removeTypingIndicator();
            }
        }

        function resetDemo() {
            clearTimeout(messageTimeout);
            clearTimeout(typingTimeout);
            currentMessageIndex = 0;
            isPlaying = false;
            isPaused = false;
            document.getElementById('chatMessages').innerHTML = '';
            document.getElementById('playButton').disabled = false;
            document.getElementById('pauseButton').disabled = true;
            document.getElementById('demoStatus').textContent = 'Ready to start';
            removeTypingIndicator();
        }

        function skipMessage() {
            if (currentMessageIndex < demoScript.length) {
                clearTimeout(messageTimeout);
                clearTimeout(typingTimeout);
                removeTypingIndicator();
                const message = demoScript[currentMessageIndex];
                addMessage(message);
                currentMessageIndex++;
                if (isPlaying && currentMessageIndex < demoScript.length) {
                    playNextMessage();
                } else if (currentMessageIndex >= demoScript.length) {
                    demoComplete();
                }
            }
        }

        function playNextMessage() {
            if (currentMessageIndex < demoScript.length && isPlaying && !isPaused) {
                const message = demoScript[currentMessageIndex];
                messageTimeout = setTimeout(() => {
                    if (message.type === 'agent') {
                        showTypingIndicator();
                        typingTimeout = setTimeout(() => {
                            removeTypingIndicator();
                            addMessage(message);
                            currentMessageIndex++;
                            if (currentMessageIndex < demoScript.length) {
                                playNextMessage();
                            } else {
                                demoComplete();
                            }
                        }, message.typingTime || 2000);
                    } else {
                        addMessage(message);
                        currentMessageIndex++;
                        if (currentMessageIndex < demoScript.length) {
                            playNextMessage();
                        } else {
                            demoComplete();
                        }
                    }
                }, message.delay || 1000);
            }
        }

        function demoComplete() {
            isPlaying = false;
            document.getElementById('playButton').disabled = false;
            document.getElementById('pauseButton').disabled = true;
            document.getElementById('demoStatus').textContent = 'Demo complete';
        }

        function addMessage(message) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            const time = new Date().toLocaleString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
            
            if (message.type === 'user') {
                messageDiv.innerHTML = `
                    <div class="message-header">
                        <div class="message-avatar-user">PM</div>
                        <span class="message-author" style="font-weight: 600;">Procurement Manager</span>
                        <span class="message-time" style="font-size: 12px; color: #a19f9d;">${time}</span>
                    </div>
                    <div class="message-content">${message.content}</div>
                `;
            } else if (message.type === 'agent') {
                let html = `
                    <div class="message-header">
                        <div class="message-avatar-agent">PA</div>
                        <span class="message-author" style="font-weight: 600;">Procurement Agent</span>
                        <span class="message-time" style="font-size: 12px; color: #a19f9d;">${time}</span>
                    </div>
                    <div class="message-content">${message.content}</div>
                `;
                
                if (message.agentData) {
                    for (const [category, data] of Object.entries(message.agentData)) {
                        html += `
                            <div class="agent-card">
                                <div class="agent-card-header">
                                    <span style="font-size: 20px;">${getIconForCategory(category)}</span>
                                    <span style="font-weight: 600;">${category}</span>
                                </div>
                                <div class="agent-card-content">
                                    <ul class="detail-list">
                        `;
                        for (const [key, value] of Object.entries(data)) {
                            html += `
                                <li class="detail-item">
                                    <span class="detail-label">${key}:</span>
                                    <span class="detail-value">${value}</span>
                                </li>
                            `;
                        }
                        html += `
                                    </ul>
                                </div>
                            </div>
                        `;
                    }
                }
                
                messageDiv.innerHTML = html;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function getIconForCategory(category) {
            const icons = {
                'Approved Vendors': 'üè¢',
                'Vendor Comparison': 'üìä',
                'Recent Performance': 'üìà',
                'Purchase Order Details': 'üìã',
                'Line Items': 'üì¶',
                'Financial Summary': 'üí∞',
                'Approval Workflow': '‚úÖ',
                'Approval Status Update': 'üîÑ',
                'Teams Notification Sent': 'üí¨',
                'Alternative Actions': 'üí°',
                'Q4 2024 IT Spending': 'üìä',
                'Category Breakdown': 'üìà',
                'Vendor Distribution': 'üè¢',
                'Budget Recommendations': 'üí°',
                'RFQ Created': 'üìù',
                'Items Requested': 'ü™ë',
                'Vendors Notified': 'üìß',
                'Evaluation Criteria': '‚öñÔ∏è'
            };
            return icons[category] || 'üìå';
        }

        function showTypingIndicator() {
            const chatMessages = document.getElementById('chatMessages');
            const indicator = document.createElement('div');
            indicator.id = 'typingIndicator';
            indicator.className = 'typing-indicator';
            indicator.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
            chatMessages.appendChild(indicator);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function removeTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) {
                indicator.remove();
            }
        }
    </script>
</body>
</html>